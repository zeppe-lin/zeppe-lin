Description: CVE-2018-20020
 heap out-of-bound write vulnerability inside structure in VNC client code that
 can result remote code execution
---

Author: Abhijith PA <abhijith@debian.org>
Origin: https://github.com/LibVNC/libvncserver/commit/7b1ef0ffc4815cab9a96c7278394152bdc89dc4d
Bug: https://github.com/LibVNC/libvncserver/issues/250
Bug-Debian: https://bugs.debian.org/916941
Last-Update: 2018-12-23

--- a/vnc_unixsrc/vncviewer/corre.c
+++ b/vnc_unixsrc/vncviewer/corre.c
@@ -76,7 +76,7 @@
     FillRectangle(rx, ry, rw, rh, gcv.foreground);
 #endif
 
-    if (!ReadFromRFBServer(buffer, hdr.nSubrects * (4 + (BPP / 8))))
+    if (hdr.nSubrects > BUFFER_SIZE / (4 + (BPP / 8)) || !ReadFromRFBServer(buffer, hdr.nSubrects * (4 + (BPP / 8))))
 	return False;
 
     ptr = (CARD8 *)buffer;
